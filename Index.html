<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ü—Ä–µ–º–∏—É–º-—Å–æ–ª–Ω–µ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –†–æ—Å—Å–∏–∏</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <style>
    :root {
      --glow: 0 0 15px rgba(0, 220, 255, 0.7);
      --primary: #00e0ff;
      --dark: #050a15;
      --darker: #020610;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--darker);
      color: #e0f7ff;
      font-family: 'Exo 2', sans-serif;
      overflow-x: hidden;
      position: relative;
      line-height: 1.6;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: radial-gradient(circle at 30% 20%, #001122 0%, var(--darker) 70%);
      z-index: -2;
    }
    .particles {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
    }
    .particle {
      position: absolute;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0.3;
      animation: float 15s infinite linear;
    }
    @keyframes float {
      0% { transform: translateY(0) translateX(0); opacity: 0; }
      10% { opacity: 0.4; }
      90% { opacity: 0.2; }
      100% { transform: translateY(-100vh) translateX(100px); opacity: 0; }
    }
    header {
      text-align: center;
      padding: 60px 20px 30px;
      position: relative;
    }
    h1 {
      font-family: 'Orbitron', monospace;
      font-size: 3.2rem;
      background: linear-gradient(90deg, var(--primary), #0077ff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 16px;
      text-shadow: 0 0 20px rgba(0, 224, 255, 0.3);
    }
    .subtitle {
      font-size: 1.3rem;
      max-width: 800px;
      margin: 0 auto;
      color: #a0d8ff;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px 60px;
    }
    .section {
      margin: 50px 0;
      background: rgba(10, 20, 40, 0.6);
      border: 1px solid rgba(0, 180, 255, 0.2);
      border-radius: 20px;
      padding: 30px;
      backdrop-filter: blur(10px);
      box-shadow: var(--glow), 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    .section h2 {
      font-family: 'Orbitron', monospace;
      font-size: 1.8rem;
      color: var(--primary);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .btn {
      background: rgba(0, 200, 255, 0.2);
      color: var(--primary);
      border: 1px solid var(--primary);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Exo 2', sans-serif;
      font-size: 0.9rem;
      transition: all 0.3s;
    }
    .btn:hover {
      background: rgba(0, 200, 255, 0.3);
      box-shadow: 0 0 10px rgba(0, 200, 255, 0.5);
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .stat-card {
      background: rgba(0, 40, 80, 0.4);
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid rgba(0, 150, 255, 0.3);
    }
    .stat-value {
      font-size: 1.8rem;
      font-weight: bold;
      color: #00ffcc;
      margin: 10px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 0.85rem;
    }
    th, td {
      padding: 10px 8px;
      text-align: center;
      border-bottom: 1px solid rgba(100, 180, 255, 0.2);
    }
    th {
      background: rgba(0, 80, 150, 0.4);
      color: var(--primary);
    }
    tr:hover {
      background: rgba(0, 100, 200, 0.2);
    }
    .highlight { color: #00ffcc; font-weight: bold; }
    .footer {
      text-align: center;
      padding: 30px;
      color: #80b0d0;
      font-size: 0.9rem;
    }
    .note {
      font-size: 0.85rem;
      color: #88c0e0;
      margin-top: 15px;
      font-style: italic;
    }
    .calculator {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .calc-input {
      background: rgba(0, 30, 60, 0.6);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    .calc-input input, .calc-input select {
      width: 80%;
      padding: 6px;
      background: #001122;
      border: 1px solid var(--primary);
      color: white;
      text-align: center;
    }
    .calc-result {
      font-size: 1.2rem;
      font-weight: bold;
      color: #00ffcc;
    }
    form {
      display: grid;
      gap: 15px;
    }
    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }
    input[type="email"], input[type="text"], input[type="tel"], textarea, select {
      width: 100%;
      padding: 10px;
      background: rgba(0, 20, 40, 0.5);
      border: 1px solid rgba(0, 150, 255, 0.4);
      color: white;
      border-radius: 8px;
    }
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    .success-message {
      color: #00ffcc;
      font-weight: bold;
      margin-top: 10px;
      display: none;
    }
    @media (max-width: 768px) {
      h1 { font-size: 2.2rem; }
      .subtitle { font-size: 1rem; }
      .section { padding: 20px; }
      table { font-size: 0.75rem; }
      .btn { font-size: 0.8rem; padding: 6px 12px; }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

  <div class="particles" id="particles"></div>

  <header>
    <h1>–ü—Ä–µ–º–∏—É–º-—Å–æ–ª–Ω–µ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –†–æ—Å—Å–∏–∏</h1>
    <p class="subtitle">–ë–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –°–≠–° 5‚Äì15 –∫–í—Ç –Ω–∞ –±–∞–∑–µ N-type BC-–ø–∞–Ω–µ–ª–µ–π. –ú–æ—Å–∫–≤–∞ –∏ –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å.</p>
  </header>

  <div class="container" id="pdfContent">

    <!-- –ö–Ω–æ–ø–∫–∞ PDF -->
    <div style="text-align: center; margin-bottom: 30px;">
      <button class="btn" onclick="saveToPDF()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF</button>
    </div>

    <!-- –°—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ -->
    <div class="section">
      <h2>üöÄ –°—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞</h2>
      <p><strong>–ü—Ä–µ–º–∏—É–º-—Å–æ–ª–Ω–µ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –†–æ—Å—Å–∏–∏</strong> ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã—Ö —Å–æ–ª–Ω–µ—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –¥–ª—è —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞.</p>
      <ul style="padding-left: 20px; margin-top: 10px;">
        <li><strong>–ü—Ä–æ–¥–∞–∂–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</strong> ‚Äî –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏ (–æ–Ω–ª–∞–π–Ω, —Å–∞–º–æ–≤—ã–≤–æ–∑, –¥–æ—Å—Ç–∞–≤–∫–∞)</li>
        <li><strong>–ú–æ–Ω—Ç–∞–∂ –°–≠–°</strong> ‚Äî –ú–æ—Å–∫–≤–∞ –∏ –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å (5‚Äì25 –∫–í—Ç, –ø–æ–¥ –∫–ª—é—á)</li>
        <li><strong>–ê–∫—Ü–µ–Ω—Ç</strong> ‚Äî –Ω–µ –Ω–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏, –∞ –Ω–∞ <strong>–∞–≤—Ç–æ–Ω–æ–º–∏–∏, –∫–æ–º—Ñ–æ—Ä—Ç–µ –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</strong></li>
        <li>–°–∏—Å—Ç–µ–º—ã –≤–∫–ª—é—á–∞—é—Ç: –ø–∞–Ω–µ–ª–∏, –∏–Ω–≤–µ—Ä—Ç–æ—Ä—ã, LiFePO‚ÇÑ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã, –º–æ–Ω—Ç–∞–∂, –¢–û</li>
      </ul>
    </div>

    <!-- –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–ª–∞–Ω -->
    <div class="section">
      <h2>üìä –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–ª–∞–Ω</h2>
      <table>
        <tr><th>–°—Ç–∞—Ç—å—è</th><th>–°—É–º–º–∞ (‚ÇΩ)</th></tr>
        <tr><td>–ó–∞–∫—É–ø–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (4 –ø–∞–ª–ª–µ—Ç–∞ = 144 —à—Ç)</td><td>1 728 000</td></tr>
        <tr><td>–ò–Ω–≤–µ—Ä—Ç–æ—Ä—ã + –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã (–Ω–∞ 10 –ø—Ä–æ–µ–∫—Ç–æ–≤)</td><td>800 000</td></tr>
        <tr><td>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</td><td>250 000</td></tr>
        <tr><td>–°–∞–π—Ç, CRM, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ (6 –º–µ—Å—è—Ü–µ–≤)</td><td>300 000</td></tr>
        <tr><td>–†–µ–∑–µ—Ä–≤–Ω—ã–π —Ñ–æ–Ω–¥</td><td>422 000</td></tr>
        <tr style="background:rgba(0,50,100,0.3);"><td><strong>–ò—Ç–æ–≥–æ</strong></td><td><strong>3 500 000 ‚ÇΩ</strong></td></tr>
      </table>
      <p class="note">*–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –æ—Ç 2.5 –º–ª–Ω –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å 2 –ø–∞–ª–ª–µ—Ç –∏ 5 –ø—Ä–æ–µ–∫—Ç–æ–≤. –ú–æ–¥–µ–ª—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞.</p>
    </div>

    <!-- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≥–æ–¥–æ–≤–æ–π –≤—ã—Ä–∞–±–æ—Ç–∫–∏ -->
    <div class="section">
      <h2>üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≥–æ–¥–æ–≤–æ–π –≤—ã—Ä–∞–±–æ—Ç–∫–∏</h2>
      <div class="calculator">
        <div class="calc-input">
          <label>–ú–æ—â–Ω–æ—Å—Ç—å –ø–∞–Ω–µ–ª–∏</label>
          <select id="panelPower" class="interactive">
            <option value="595">595 –í—Ç (SE5-72HBD)</option>
            <option value="630">630 –í—Ç (SE6R-66H)</option>
            <option value="670">670 –í—Ç (LONGi LR7)</option>
            <option value="750">750 –í—Ç (SE6-66HBD)</option>
          </select>
        </div>
        <div class="calc-input">
          <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–Ω–µ–ª–µ–π</label>
          <input type="number" id="panelCount" class="interactive" value="10" min="1" step="1">
        </div>
        <div class="calc-input">
          <label>–†–µ–≥–∏–æ–Ω –†–§</label>
          <select id="region" class="interactive">
            <option value="center">–¶–µ–Ω—Ç—Ä –∏ –Æ–≥</option>
            <option value="northwest">–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥</option>
            <option value="siberia">–°–∏–±–∏—Ä—å –∏ –î–í</option>
          </select>
        </div>
        <div class="calc-input">
          <div>–ì–æ–¥–æ–≤–∞—è –≤—ã—Ä–∞–±–æ—Ç–∫–∞</div>
          <div class="calc-result" id="output">13 500 –∫–í—Ç¬∑—á</div>
        </div>
        <div class="calc-input">
          <div>–≠–∫–æ–Ω–æ–º–∏—è –≤ –≥–æ–¥</div>
          <div class="calc-result" id="savings">108 000 ‚ÇΩ</div>
        </div>
      </div>
    </div>

    <!-- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º -->
    <div class="section">
      <h2>üåç –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –†–æ—Å—Å–∏–∏</h2>
      <table>
        <tr><th>–†–µ–≥–∏–æ–Ω</th><th>–í—ã—Ä–∞–±–æ—Ç–∫–∞ (–∫–í—Ç¬∑—á/–∫–í—Ç/–≥–æ–¥)</th><th>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</th></tr>
        <tr><td>–¶–µ–Ω—Ç—Ä –∏ –Æ–≥ (–ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä)</td><td>1350‚Äì1400</td><td>–°—Ç–∞–±–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä—É–≥–ª—ã–π –≥–æ–¥</td></tr>
        <tr><td>–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥ (–°–ü–±, –ö–∞–∑–∞–Ω—å)</td><td>1100‚Äì1300</td><td>–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–∏–∏ —Å –ê–ö–ë</td></tr>
        <tr><td>–°–∏–±–∏—Ä—å –∏ –î–í</td><td>1000‚Äì1200</td><td>–ó–∏–º–æ–π ‚Äî +20‚Äì30% –æ—Ç —Å–Ω–µ–≥–∞ (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ)</td></tr>
      </table>
    </div>

    <!-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π -->
    <div class="section">
      <h2>üî¨ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —Å–æ–ª–Ω–µ—á–Ω—ã—Ö –ø–∞–Ω–µ–ª–µ–π</h2>
      <table>
        <thead>
          <tr>
            <th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th>
            <th>SunEvo SE5-72HBD</th>
            <th>SunEvo SE6R-66H</th>
            <th>LONGi LR7-72HVH</th>
            <th>SunEvo SE6-66HBD</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è</td><td>N-Type TOPCon Bifacial</td><td>N-Type TOPCon</td><td>BC-CELL</td><td>N-Type HJT 0BB Bifacial</td></tr>
          <tr><td>Pmax</td><td>595 –í—Ç</td><td>630 –í—Ç</td><td>670 –í—Ç</td><td>750 –í—Ç</td></tr>
          <tr><td>–ö–ü–î</td><td>23.00%</td><td>23.32%</td><td>24.80%</td><td>24.10%</td></tr>
          <tr><td>Voc (–í)</td><td>53.20</td><td>49.95</td><td>54.30</td><td>50.77</td></tr>
          <tr><td>Isc (–ê)</td><td>14.15</td><td>16.05</td><td>15.60</td><td>18.71</td></tr>
          <tr><td>–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–æ—Å—Ç—å</td><td>–î–∞ (–¥–æ 25%)</td><td>–ù–µ—Ç</td><td>–ù–µ—Ç</td><td>–î–∞ (–¥–æ 95%)</td></tr>
          <tr><td>–¢–µ–º–ø. –∫–æ—ç—Ñ. Pmax</td><td>‚Äì0.28%/¬∞C</td><td>‚Äì0.30%/¬∞C</td><td>‚Äì0.26%/¬∞C</td><td>‚Äì0.24%/¬∞C</td></tr>
          <tr><td>–ì–∞—Ä–∞–Ω—Ç–∏—è –º–æ—â–Ω–æ—Å—Ç–∏</td><td>87.4%</td><td>87.4%</td><td>88.85%</td><td>90.3%</td></tr>
          <tr><td>–í–µ—Å</td><td>31.5 –∫–≥</td><td>29.5 –∫–≥</td><td>28.5 –∫–≥</td><td>37.9 –∫–≥</td></tr>
        </tbody>
      </table>
    </div>

    <!-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ P-type vs N-type -->
    <div class="section">
      <h2>üÜö –ü—Ä–µ–º–∏—É–º (N-type) vs –ë—é–¥–∂–µ—Ç (P-type)</h2>
      <table>
        <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>N-type (TOPCon, HJT, BC)</th><th>P-type (–æ–±—ã—á–Ω—ã–µ)</th></tr>
        <tr><td>–ö–ü–î</td><td>23‚Äì24.8%</td><td>18‚Äì21%</td></tr>
        <tr><td>LID (–¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –æ—Ç —Å–≤–µ—Ç–∞)</td><td>–ù–µ—Ç</td><td>–î–∞ (–¥–æ 3% –≤ 1-–π –≥–æ–¥)</td></tr>
        <tr><td>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</td><td>‚Äì0.24‚Ä¶‚Äì0.30%/¬∞C</td><td>‚Äì0.40‚Ä¶‚Äì0.45%/¬∞C</td></tr>
        <tr><td>–ì–∞—Ä–∞–Ω—Ç–∏—è –º–æ—â–Ω–æ—Å—Ç–∏</td><td>87‚Äì90% —á–µ—Ä–µ–∑ 30 –ª–µ—Ç</td><td>80‚Äì82% —á–µ—Ä–µ–∑ 25 –ª–µ—Ç</td></tr>
        <tr><td>–¶–µ–Ω–∞ –∑–∞ –í—Ç</td><td>18‚Äì22 ‚ÇΩ/–í—Ç</td><td>12‚Äì15 ‚ÇΩ/–í—Ç</td></tr>
        <tr><td>–°—Ä–æ–∫ —Å–ª—É–∂–±—ã</td><td>30+ –ª–µ—Ç</td><td>20‚Äì25 –ª–µ—Ç</td></tr>
      </table>
      <p class="note">N-type –¥–æ—Ä–æ–∂–µ, –Ω–æ –¥–∞—ë—Ç –Ω–∞ 25‚Äì30% –±–æ–ª—å—à–µ —ç–Ω–µ—Ä–≥–∏–∏ –∑–∞ 30 –ª–µ—Ç ‚Üí –Ω–∏–∂–µ LCOE.</p>
    </div>

    <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ -->
    <div class="section">
      <h2>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ (–≥–æ–¥ 1)</h2>
      <div class="calculator">
        <div class="calc-input">
          <label>–ü—Ä–æ–µ–∫—Ç–æ–≤ –≤ –≥–æ–¥</label>
          <input type="range" id="projectsSlider" class="interactive" min="1" max="24" step="1" value="12">
          <div id="projectCount">12 –ø—Ä–æ–µ–∫—Ç–æ–≤/–≥–æ–¥</div>
        </div>
        <div class="calc-input">
          <div>–í—ã—Ä—É—á–∫–∞</div>
          <div class="calc-result" id="revenue">7 800 000 ‚ÇΩ</div>
        </div>
        <div class="calc-input">
          <div>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
          <div class="calc-result" id="profit">3 000 000 ‚ÇΩ</div>
        </div>
        <div class="calc-input">
          <div>ROI</div>
          <div class="calc-result" id="roi">100%</div>
        </div>
      </div>
    </div>

    <!-- –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ -->
    <div class="section">
      <h2>üì© –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</h2>
      <form id="surveyForm">
        <label>–ò–º—è *</label>
        <input type="text" name="name" required>
        <label>Email *</label>
        <input type="email" name="email" required>
        <label>–¢–µ–ª–µ—Ñ–æ–Ω * (–Ω–∞–ø—Ä–∏–º–µ—Ä, +79001234567)</label>
        <input type="tel" name="phone" id="phone" placeholder="+7XXXXXXXXXX" required pattern="\+7[0-9]{10}">
        <label>–†–µ–≥–∏–æ–Ω *</label>
        <select name="region" required>
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
          <option value="–ú–æ—Å–∫–≤–∞ –∏ –ú–û">–ú–æ—Å–∫–≤–∞ –∏ –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
          <option value="–°–ü–± –∏ –õ–û">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –∏ –õ–û</option>
          <option value="–¶–µ–Ω—Ç—Ä">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –†–æ—Å—Å–∏—è</option>
          <option value="–°–∏–±–∏—Ä—å">–°–∏–±–∏—Ä—å / –î–∞–ª—å–Ω–∏–π –í–æ—Å—Ç–æ–∫</option>
          <option value="–Æ–≥">–Æ–≥ –†–æ—Å—Å–∏–∏</option>
        </select>
        <label>–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å *</label>
        <select name="interest" required>
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
          <option value="–ü–∞–Ω–µ–ª–∏">–¢–æ–ª—å–∫–æ –ø–∞–Ω–µ–ª–∏</option>
          <option value="–°–∏—Å—Ç–µ–º–∞">–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥ –∫–ª—é—á</option>
          <option value="–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è">–•–æ—á—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</option>
        </select>
        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
        <textarea name="comment" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ..."></textarea>
        <button type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        <div class="success-message" id="successMessage">–°–ø–∞—Å–∏–±–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞.</div>
      </form>
    </div>

  </div>

  <div class="footer">
    –ü—Ä–µ–º–∏—É–º-—Å–æ–ª–Ω–µ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –†–æ—Å—Å–∏–∏ ‚Ä¢ –î–µ–∫–∞–±—Ä—å 2025
  </div>

  <script>
    // –ß–∞—Å—Ç–∏—Ü—ã
    const particles = document.getElementById('particles');
    for (let i = 0; i < 150; i++) {
      const p = document.createElement('div');
      p.classList.add('particle');
      p.style.left = `${Math.random() * 100}%`;
      p.style.top = `${Math.random() * 100}%`;
      p.style.width = `${Math.random() * 3}px`;
      p.style.height = p.style.width;
      p.style.setProperty('--duration', `${10 + Math.random() * 10}s`);
      p.style.opacity = Math.random() * 0.4 + 0.1;
      particles.appendChild(p);
    }

    // EmailJS
    emailjs.init("V0u_hUwzxh7VagZzx");

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    document.getElementById('phone').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.startsWith('8')) value = '7' + value.slice(1);
      if (!value.startsWith('7')) value = '7' + value;
      if (value.length > 11) value = value.slice(0, 11);
      e.target.value = value ? `+${value}` : '';
    });

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
    document.getElementById('surveyForm').addEventListener('submit', function(e) {
      e.preventDefault();
      if (!this.checkValidity()) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.');
        return;
      }
      emailjs.sendForm('service_jvogd0q', 'solar-inquiry', this)
        .then(() => {
          document.getElementById('successMessage').style.display = 'block';
          this.reset();
          setTimeout(() => document.getElementById('successMessage').style.display = 'none', 5000);
        }, (error) => {
          alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
          console.error(error);
        });
    });

    // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤—ã—Ä–∞–±–æ—Ç–∫–∏ (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)
    const production = { center: 1350, northwest: 1200, siberia: 1100 };
    const tariff = 8;
    function calculateOutput() {
      const power = parseFloat(document.getElementById('panelPower').value) / 1000;
      const count = parseInt(document.getElementById('panelCount').value) || 1;
      const region = document.getElementById('region').value;
      const yearlyOutput = production[region] * power * count;
      const yearlySavings = yearlyOutput * tariff;
      document.getElementById('output').textContent = yearlyOutput.toLocaleString('ru') + ' –∫–í—Ç¬∑—á';
      document.getElementById('savings').textContent = yearlySavings.toLocaleString('ru') + ' ‚ÇΩ';
    }

    // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)
    function updateFinancials() {
      const count = parseInt(document.getElementById('projectsSlider').value) || 1;
      document.getElementById('projectCount').textContent = count + (count === 1 ? ' –ø—Ä–æ–µ–∫—Ç/–≥–æ–¥' : count < 5 ? ' –ø—Ä–æ–µ–∫—Ç–∞/–≥–æ–¥' : ' –ø—Ä–æ–µ–∫—Ç–æ–≤/–≥–æ–¥');
      const revenue = count * 650000;
      const profit = count * 250000;
      const roi = (profit / 3000000 * 100).toFixed(0);
      document.getElementById('revenue').textContent = revenue.toLocaleString('ru') + ' ‚ÇΩ';
      document.getElementById('profit').textContent = profit.toLocaleString('ru') + ' ‚ÇΩ';
      document.getElementById('roi').textContent = roi + '%';
    }

    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª—ë—Å–∏–∫–æ–º
    document.addEventListener('wheel', function(e) {
      if (e.target.type === 'number') {
        e.preventDefault();
        const step = parseFloat(e.target.step) || 1;
        const delta = e.deltaY > 0 ? -step : step;
        e.target.value = (parseFloat(e.target.value) || 0) + delta;
        if (e.target.id === 'panelCount') calculateOutput();
        if (e.target.id === 'projectsSlider') updateFinancials();
      }
    }, { passive: false });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.querySelectorAll('#panelPower, #panelCount, #region').forEach(el => el.addEventListener('input', calculateOutput));
    document.getElementById('projectsSlider').addEventListener('input', updateFinancials);
    calculateOutput();
    updateFinancials();

    // PDF —ç–∫—Å–ø–æ—Ä—Ç
    async function saveToPDF() {
      document.body.classList.add('pdf-mode');
      try {
        const content = document.getElementById('pdfContent');
        const canvas = await html2canvas(content, { scale: 1.5 });
        const imgData = canvas.toDataURL('image/png');
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const imgWidth = 210;
        const pageHeight = 297;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft >= 0) {
          position = heightLeft - imgHeight;
          pdf.addPage();
          pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;
        }

        pdf.save('–ü—Ä–µ–º–∏—É–º-—Å–æ–ª–Ω–µ—á–Ω—ã–µ_—Ä–µ—à–µ–Ω–∏—è_–ë–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω.pdf');
      } catch (e) {
        alert('–û—à–∏–±–∫–∞ PDF. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ Chrome.');
        console.error(e);
      } finally {
        document.body.classList.remove('pdf-mode');
      }
    }
  </script>
</body>
</html>